<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // Xây dựng một ứng dụng cho phép người dùng nhập các lựa chọn sau:
      // Nếu chọn 1: Thực hiện chức năng đăng ký tài khoản, đối tượng user
      // thêm vào gồm các thông tin sau: id, user_name, email, password.
      // Thực hiện validate dữ liệu: tên không được để trống, email phải đúng định dạng,
      // mật khẩu phải dài tối thiểu 8 ký tự,
      // email nhập vào không được phép trùng với email đã tồn tại trong mảng.
      // Nếu các giá trị thêm vào thỏa mãn thì tiến hành thêm dữ liệu vào trong mảng
      // Nếu chọn 2: Thực hiện chức năng đăng nhập.
      // Cho phép người dùng nhập vào email và password.
      // Nếu email và password không khớp với thông tin
      // của các user trong mảng thì thông báo “Đăng nhập thất bại” và yêu cầu người dùng nhập lại.
      // Nếu email và password khớp với dữ liệu trong mảng thì thông báo “Đăng nhập thành công” và
      // hiển thị thông tin của tài khoản vừa đăng nhập thành công ra ngoài màn hình
      // Nếu chọn 3: Thoát chương trình

      const users = [];

      let choose;
      do {
        choose = prompt(
          `
            1. R: Register
            2. L: Login
            3. E: Exit
        `
        );
        choose = choose.toLowerCase();
        switch (choose) {
          case "r":
            register();
            break;
          case "l":
            login();
            break;
          case "e":
            console.log(users);
            break;
        }
      } while (choose.toLowerCase() !== "e");

      function register() {
        let id = 1;
        if (users.length > 0) {
          id = users[users.length - 1].id + 1;
        }
        const user = {
          id,
          name: "",
          email: "",
          password: "",
        };
        let name, email, password;

        do {
          name = prompt("Enter name register: ");
        } while (!isNaN(username) || username.length < 3);

        do {
          email = prompt("Enter email register: ");
        } while (!/^\w+([.-]?\w+)@\w+([.-]?\w+)(.\w{2,3})+$/.test(email));

        do {
          password = prompt("Enter password register: ");
        } while (password.length < 8);

        user.name = name;
        user.email = email;
        user.password = password;

        users.push(user);
      }

      function login() {
        let emailLogin, passwordLogin;
        emailLogin = prompt("Enter email login: ");
        passwordLogin = prompt("Enter password login: ");

        const findUser = users.find(
          (user) => user.email === emailLogin && user.password === passwordLogin
        );

        if (!findUser) {
          console.log("Fail");
        } else {
          console.log("Success");
        }
      }
    </script>
  </body>
</html>
